<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Flight Checkout</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: "Poppins", sans-serif;
        background: linear-gradient(135deg, #eef5ff, #e6f0ff);
        min-height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .checkout-container {
        max-width: 700px;
        width: 100%;
        background: #fff;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        overflow: hidden;
        margin: 30px;
      }
      .checkout-header {
        background: linear-gradient(90deg, #007bff, #00c6ff);
        color: white;
        text-align: center;
        padding: 25px 30px;
      }
      .checkout-header h2 {
        font-size: 28px;
        font-weight: 600;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 5px;
      }
      .checkout-header h2 i {
        margin-right: 10px;
      }
      .checkout-header p {
        font-size: 15px;
        opacity: 0.9;
      }

      .checkout-body {
        padding: 30px;
      }

      /* Flight Card */
      .flight-card {
        background: #f8f9fa;
        padding: 25px;
        border-radius: 12px;
        margin-bottom: 30px;
        border-left: 4px solid #007bff;
      }
      .flight-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #e9ecef;
        padding-bottom: 10px;
        margin-bottom: 15px;
      }
      .flight-header h3 {
        font-size: 22px;
        font-weight: 600;
        color: #333;
      }
      .flight-number {
        background: #e9ecef;
        padding: 6px 12px;
        border-radius: 20px;
        font-weight: 500;
      }
      .flight-details {
        display: grid;
        grid-template-columns: 1fr auto 1fr;
        gap: 20px;
        align-items: center;
        margin-bottom: 20px;
      }
      .departure,
      .arrival {
        text-align: center;
      }
      .departure h4,
      .arrival h4 {
        font-size: 24px;
        color: #333;
        margin-bottom: 5px;
      }
      .departure p,
      .arrival p {
        color: #6c757d;
        font-size: 14px;
      }
      .flight-path {
        text-align: center;
        position: relative;
      }
      .flight-line {
        width: 100px;
        height: 3px;
        background: #e9ecef;
        margin: 5px auto;
        border-radius: 2px;
        position: relative;
      }
      .flight-line::before,
      .flight-line::after {
        content: "";
        position: absolute;
        width: 10px;
        height: 10px;
        border-radius: 50%;
        top: -3.5px;
      }
      .flight-line::before {
        background: #28a745;
        left: 0;
      }
      .flight-line::after {
        background: #dc3545;
        right: 0;
      }
      .plane-icon {
        color: #007bff;
        position: absolute;
        top: -10px;
        left: 50%;
        transform: translateX(-50%);
      }

      .price-section {
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-top: 1px solid #e9ecef;
        padding-top: 15px;
      }
      .price-label {
        font-size: 16px;
        color: #6c757d;
      }
      .price-amount {
        font-size: 22px;
        font-weight: 600;
        color: #28a745;
      }

      /* Form */
      .section-title {
        font-weight: 600;
        color: #333;
        margin: 20px 0 10px;
        display: flex;
        align-items: center;
      }
      .section-title i {
        margin-right: 8px;
        color: #007bff;
      }

      .input-group {
        margin-bottom: 15px;
      }
      .input-group label {
        font-weight: 500;
        color: #495057;
        margin-bottom: 6px;
        display: block;
      }
      .input-group input {
        width: 100%;
        padding: 12px 15px;
        border-radius: 8px;
        border: 1px solid #ced4da;
        font-size: 15px;
      }
      .input-group input:focus {
        border-color: #007bff;
        outline: none;
      }

      /* Payment */
      .payment-methods {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }
      .payment-option {
        border: 2px solid #e9ecef;
        border-radius: 10px;
        padding: 15px;
        text-align: center;
        cursor: pointer;
        transition: 0.3s;
      }
      .payment-option:hover,
      .payment-option.selected {
        border-color: #007bff;
        background: #f0f7ff;
      }
      .payment-icon {
        font-size: 24px;
        color: #6c757d;
        margin-bottom: 10px;
      }
      .payment-option.selected .payment-icon {
        color: #007bff;
      }

      .summary-section {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        margin-top: 25px;
      }
      .summary-item {
        display: flex;
        justify-content: space-between;
        margin-bottom: 12px;
      }
      .summary-item:last-child {
        border-top: 1px solid #e9ecef;
        padding-top: 10px;
        font-weight: 600;
      }
      .total-price {
        color: #28a745;
      }

      .btn-confirm {
        background: linear-gradient(90deg, #28a745, #20c997);
        color: white;
        border: none;
        padding: 15px;
        border-radius: 10px;
        font-size: 17px;
        font-weight: 600;
        width: 100%;
        margin-top: 20px;
        cursor: pointer;
        transition: 0.3s;
      }
      .btn-confirm:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
      }

      @media (max-width: 768px) {
        .checkout-container {
          margin: 15px;
        }
        .payment-methods {
          grid-template-columns: 1fr;
        }
        .flight-details {
          grid-template-columns: 1fr;
        }
      }
    </style>
  </head>
  <body>
    <div class="checkout-container">
      <div class="checkout-header">
        <h2><i class="fas fa-plane"></i> Flight Checkout</h2>
        <p>Review your flight details and confirm payment</p>
      </div>

      <div class="checkout-body">
        <div class="flight-card">
          <div class="flight-header">
            <h3>{{ airline }}</h3>
            <div class="flight-number">{{ flight_no }}</div>
          </div>

          <div class="flight-details">
            <div class="departure">
              <h4>{{ dep_airport }}</h4>
              <p>Departure</p>
              <p>{{ dep_time }}</p>
            </div>

            <div class="flight-path">
              <div class="flight-line">
                <i class="fas fa-plane plane-icon"></i>
              </div>
            </div>

            <div class="arrival">
              <h4>{{ arr_airport }}</h4>
              <p>Arrival</p>
              <p>{{ arr_time }}</p>
            </div>
          </div>

          <div class="price-section">
            <div class="price-label">Base Fare</div>
            <div class="price-amount">â‚¹{{ price }}</div>
          </div>
        </div>

        <form
          method="POST"
          action="{% url 'confirm_payment' %}"
          class="confirm-form"
        >
          {% csrf_token %}
          <input type="hidden" name="airline" value="{{ airline }}" />
          <input type="hidden" name="flight_no" value="{{ flight_no }}" />
          <input type="hidden" name="dep_airport" value="{{ dep_airport }}" />
          <input type="hidden" name="arr_airport" value="{{ arr_airport }}" />
          <input type="hidden" name="dep_time" value="{{ dep_time }}" />
          <input type="hidden" name="arr_time" value="{{ arr_time }}" />
          <input
            type="hidden"
            name="price"
            id="hidden_price"
            value="{{ price }}"
          />
          <input type="hidden" name="payment_method" id="payment_method" />

          <div class="section-title">
            <i class="fas fa-users"></i> Passenger Details
          </div>
          <div class="input-group">
            <label for="passengers">Number of Passengers</label>
            <input
              type="number"
              name="passengers"
              id="passengers"
              value="1"
              min="1"
              max="9"
              required
            />
          </div>
          <div class="input-group">
            <label for="fullname">Full Name</label>
            <input
              type="text"
              name="fullname"
              id="fullname"
              placeholder="Enter full name"
              required
            />
          </div>
          <div class="input-group">
            <label for="email">Email</label>
            <input
              type="email"
              name="email"
              id="email"
              placeholder="Enter email"
              required
            />
          </div>
          <div class="input-group">
            <label for="phone">Phone</label>
            <input
              type="tel"
              name="phone"
              id="phone"
              placeholder="Enter phone number"
              required
            />
          </div>

          <div class="section-title">
            <i class="fas fa-credit-card"></i> Payment Method
          </div>
          <div class="payment-methods">
            <div class="payment-option" onclick="selectPayment(this)">
              <div class="payment-icon"><i class="fab fa-cc-visa"></i></div>
              <div class="payment-name">Credit Card</div>
            </div>
            <div class="payment-option" onclick="selectPayment(this)">
              <div class="payment-icon"><i class="fas fa-mobile-alt"></i></div>
              <div class="payment-name">UPI</div>
            </div>
            <div class="payment-option" onclick="selectPayment(this)">
              <div class="payment-icon"><i class="fas fa-university"></i></div>
              <div class="payment-name">Net Banking</div>
            </div>
            <div class="payment-option" onclick="selectPayment(this)">
              <div class="payment-icon"><i class="fas fa-wallet"></i></div>
              <div class="payment-name">Wallet</div>
            </div>
          </div>

          <div class="summary-section">
            <div class="summary-item">
              <span>Base Fare</span>
              <span id="baseFare">â‚¹{{ price }}</span>
            </div>
            <div class="summary-item">
              <span>Taxes & Fees</span>
              <span>â‚¹800</span>
            </div>
            <div class="summary-item">
              <span>Convenience Fee</span>
              <span>â‚¹200</span>
            </div>
            <div class="summary-item">
              <span>Total Amount</span>
              <span class="total-price" id="totalAmount">â‚¹{{ price }}</span>
            </div>
          </div>

          <button type="submit" class="btn-confirm" id="payBtn">
            <i class="fas fa-lock"></i> Confirm & Pay â‚¹{{ price }}
          </button>
        </form>
      </div>
    </div>

    <script>
      function selectPayment(element) {
        document
          .querySelectorAll(".payment-option")
          .forEach((opt) => opt.classList.remove("selected"));
        element.classList.add("selected");
        document.getElementById("payment_method").value =
          element.querySelector(".payment-name").innerText;
      }

      // initialize with first selected
      document.addEventListener("DOMContentLoaded", () => {
        const first = document.querySelector(".payment-option");
        if (first) selectPayment(first);
      });

      // Update total dynamically
      const basePrice = parseFloat("{{ price }}");
      const taxes = 800,
        fee = 200;
      const passengerInput = document.getElementById("passengers");
      const totalDisplay = document.getElementById("totalAmount");
      const payBtn = document.getElementById("payBtn");
      const hiddenPrice = document.getElementById("hidden_price");

      passengerInput.addEventListener("input", () => {
        const count = parseInt(passengerInput.value || 1);
        const total = basePrice * count + taxes + fee;
        totalDisplay.textContent = `â‚¹${total}`;
        payBtn.innerHTML = `<i class="fas fa-lock"></i> Confirm & Pay â‚¹${total}`;
        hiddenPrice.value = total;
      });
    </script>
  </body>
</html>
